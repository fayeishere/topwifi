<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Top Wifi Spaces</title>
        <meta name="description" content="The top wifi speeds in coffee shops, cafes, and coworking spaces near you.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Facebook and Google Plus--> 
        <meta property="og:title" content="Top Wifi Spaces - Fastest wifi spots nearby"> 
        <meta property="og:type" content="website"> 
        <meta property="og:url" content="http://topwifi.space"> 
        <meta property="og:image" content="http://topwifi.space/img/share.png"> 
        <meta property="og:site_name" content="Top Wifi Space"> 
        <meta property="og:description" content=“og:description" content=“Find the fastest wifi spots nearby in coffee shops, cafes, and bars."> 
        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="Top Wifi Spaces - Fastest wifi spots nearby" /> 
        <meta name="twitter:description" content="Find the fastest wifi spots nearby in coffee shops, cafes, and bars." /> 
        <meta name="twitter:image" content="http://topwifi.space/img/share.png" /> 
        <meta name="twitter:url" content="http://topwifi.space" /> 
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link href='http://fonts.googleapis.com/css?family=Press+Start+2P' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->


        <div class="main-container">
            <div class="main wrapper clearfix">
                <h3>Top Scores</h3>
                <div id="winner-content">
                    <div class="column">Rank</div>
                    <div class="column">Score</div>
                    <div class="column">Name</div>
                </div>
                <div id="content">
                </div>   

            </div> <!-- #main -->
        </div> <!-- #main-container -->

        <div class="header-container">
            <header class="wrapper clearfix">
                <div>
                    <h2>Popular cities: </h2>
                    <a href="#" class="cities">Portland</a>
                    <a href="#" class="cities">NYC</a>
                    <a href="#" class="cities">Seattle</a>
                    <a href="#" class="cities">San-Francisco</a>
                    <a href="#" class="cities">Chicago</a>
                </div>
                <a target="_blank" class="popup" href="http://twitter.com/home?status=Top wifi spaces near you. http://topwifi.space/"><img class="social" src="img/twitter-icon.png"></a>

<!--                 <img class="social" src="img/facebook-icon.png"> -->
                <h1 class="title">Top Wifi Spaces Near You</h1>
                <h2 id="powered"> sourced from <a href="https://workfrom.co"></h2>
                <img id="logo" src="/img/WorkfromLogo.png"></a>
                <p id="sub">Fastest wifi download speeds from work spaces including cafes, coffee shops, libraries, and co-working offices.</p>
            </header>
        </div>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

        <script src="js/main.js"></script>
        <script type="text/javascript">

        getLocation();

            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition);
                } else {
                    x.innerHTML = "Geolocation is not supported by this browser.";
                }
            }
            function showPosition(position) {
                latitude = position.coords.latitude;
                longitude = position.coords.longitude;
                // latitude = 47.0425;
                // longitude = -122.8931;
                // // atlanta
                // latitude = 33.7550;
                // longitude = -84.3900;


                getCity(latitude, longitude);
            }

            function getCity(latitude, longitude){

                var url = "http://api.workfrom.co/places/ll/" + latitude + "," + longitude + "?appid=fayerocks";
                $.getJSON( url, function( data ) {
                    // console.log(data.response[0].alcohol);
                    parseJson(data);

                });
                // Be cool to allow user to toggle upload/download
                function parseJson(data){
                    var places = data.response;
                    if(places.length == 0){
                        var geocoder = new google.maps.Geocoder;

                        var latlng = {lat: latitude, lng: longitude};
                          geocoder.geocode({'location': latlng}, function(results, status) {
                            if (status === google.maps.GeocoderStatus.OK) {
                              if (results[3]) {
                                // console.log(results[3].address_components[1].long_name);
                                var city = results[3].address_components[1].long_name;
                                getCityAPI(city);
                              } else {
                                window.alert('No results found in your area. Check out workfrom.co to add your favorite work spot to this list.');
                              }
                            } else {
                              window.alert('Geocoder failed due to: ' + status);
                            }
                          });
                    }
                    else{
                        reorder(places);
                    }


     
                }
                $( ".cities" ).click(function(e) {
                    $( "#content" ).empty();
                    getCityAPI($(this).html());
                });
                function getCityAPI(city){
                    var cityUrl = "http://api.workfrom.co/places/city/" + city + "?appid=fayerocks";
                    $.getJSON( cityUrl, function( data ) {
                        cityPlaces = data.response;
                        if(cityPlaces.length == 0){
                            window.alert('Sorry, no results found in ' + city + 'Check out workfrom.co to add your favorite work spot to this list.');
                        }
                        else{
                            reorder(cityPlaces);
                        }
                    });
                }
                function reorder(places){
                    var placesDown = places;
                    var placesUp = places;
                    placesDown.sort(function(a, b){return b.download-a.download});
                    var rank = ["First", "Second", "Third", "Fourth", "Fifth", "Sixth", "Seventh", "Eighth", "Ninth", "Tenth"];


                    // hard code 10 slots
                    var restrict = 10;
                    for (i = 0; (i < restrict) & (i < places.length); i++) {
                        var rankLow = rank[i].toLowerCase();
                        if(placesDown[i].download > 5){
                            $( "#content" ).append( '<div id=' + rankLow + '><div class="player">' + rank[i] + '</div><div class="player">' + placesDown[i].download + '</div><div class="player"><a href="https://workfrom.co/' + placesDown[i].slug + '">' + placesDown[i].title + '</a></div></div>' );
                        }

                    }
                }
            }

        </script>
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-64258300-1', 'auto');
          ga('send', 'pageview');

        </script>
    </body>
</html>